<!doctype html><html lang="en"><head><meta charset="utf-8"><title>Jekyll archives without plugins, Roobottom.com</title><meta name="description" content=""><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="/styles.css" type="text/css" media="all"></head><body class="page-type-article"><header class="c_header"><div class="c_header__content"><div class="m_siteHeader"><a href="/" class="m_siteHeader__titleLink" title="Go to the homepage"><span class="m_siteHeader__intro">The personal website of</span> <span class="m_siteHeader__name">Jon Roobottom</span> </a><a href="#main-menu" class="m_siteHeader__menuLink" title="Toggle the main menu" data-fullscreen-trigger="#main-menu"><svg aria-hidden="true" class="m_icon m_icon--menu m_siteHeader__menuIcon m_icon--small" data-alt-icon="menu-close"><use xlink:href="/assets/sprites.svg#menu"></use></svg></a></div></div></header><main class="c_page"><div class="c_page__content"><nav class="m_breadcrumbs" role="navigation" aria-label="breadcrumbs"><div class="m_breadcrumbs__icons" aria-hidden="true"><svg aria-hidden="true" class="m_icon m_icon--arm m_breadcrumbs__arm"><use xlink:href="/assets/sprites.svg#arm"></use></svg> <svg aria-hidden="true" class="m_icon m_icon--hand-point-right m_breadcrumbs__hand"><use xlink:href="/assets/sprites.svg#hand-point-right"></use></svg></div><p class="m_breadcrumbs__label" id="m_breadcrumbs__label_20">You're here:</p><ol class="m_breadcrumbs__items" aria-labeledby="m_breadcrumbs__label_20"><li class="m_breadcrumbs__item"><a href="/" class="m_breadcrumbs__link">Home</a> <span class="m_breadcrumbs__seperator" aria-hidden="true">/</span></li><li class="m_breadcrumbs__item"><a href="/articles" class="m_breadcrumbs__link">Articles</a> <span class="m_breadcrumbs__seperator" aria-hidden="true">/</span></li><li class="m_breadcrumbs__item">Jekyll archives without plugins</li></ol></nav><div class="m_pageTitle"><h1 class="m_pageTitle__title">Jekyll archives without<span class="u_widow" aria-hidden="true"><span class="u_widow__nbsp">&#160;</span></span>plugins</h1><time datetime="Fri Aug 28 2015 01:00:00 GMT+0100 (BST)" class="m_pageTitle__date">Friday, August 28th 2015</time></div><article class="m_prose"><p>I recently made the switch to <a href="http://jekyllrb.com">Jekyll</a> as my publishing tool for this website. I love it, not least as it lets me serve content directly from Github. Updating the site is as simple as pushing into my repository. I have no servers to maintain and no extra monthly costs. For a low traffic site it seems, for now at least, like the perfect solution.</p><figure class="m_figure"><img src="/images/articles/51/2015-09-01-artwork.jpg" class="m_figure__image"></figure><p>To me, one of the most interesting things about writing a blog is the ability to look back, to make old posts new again with an easily navigable archive section. A key part of that is the ‘archives for year …’ page. However, hosting with Github pages means that I can’t use plugins for Jekyll that you’d normally need to achieve this. Jekyll doesn’t really offer much in the way of core functionality for archives, but with a bit of hacking you can create an archive page for every year in a way that doesn’t suck.</p><p>We can use the power of <a href="http://jekyllrb.com/docs/collections/">Jekyll collections</a> to <em>somewhat</em> automatically generate an archive page for each year your site has posts. There’s three main parts to the setup:</p><ol><li>Configure a collection for archives.</li><li>Create a post for each year for which you want an archive page.</li><li>Create a layout for processing each archive post into &lt;abbr title=&quot;Hyper Text Markup Language&quot;&gt;HTML&lt;/abbr&gt;</li></ol><h2>Configure the archives collection</h2><p>First, we need to tell Jekyll about our new collection. In my site configuration file, (usually <code>_config.yml</code>) I added the following:</p><pre><code><span class="hljs-symbol">collections:</span>
<span class="hljs-symbol">  archives:</span>
<span class="hljs-symbol">    output:</span> true
<span class="hljs-symbol">    permalink:</span> <span class="hljs-meta-keyword">/archives/</span>:path/
</code></pre><p>This tells Jekyll that we want a collection called <strong>archives</strong>, that we want it to output an <code>index.html</code> for each item in the collection, and we want it to do so under the <code>/archives</code> url.</p><h2>Create a post per year</h2><p>Our new archives collection will read any markdown files in a folder named <code>_archives</code>, so we’ll have to create a post for each year your site has posts in this folder. This is why I say that this method is only <em>somewhat</em> automatic, however we’ll only every have to worry about updating this once per year.</p><p>For example, if we want an archive page for 2015 at <code>archives/2015</code> we’d create the post <code>_archives/2015.md</code>. The only thing that’s really required here is YML front matter, here’s a simplified version of my <code>2015.md</code>:</p><pre><code><span class="hljs-meta">---</span>
<span class="hljs-attr">title:</span> Archives for <span class="hljs-number">2015</span>
<span class="hljs-attr">year:</span> <span class="hljs-string">"2015"</span>
<span class="hljs-attr">layout:</span> archive-year
<span class="hljs-meta">---</span>
</code></pre><p>Don’t forget the quotation marks, the reason for them will shortly become apparent.</p><h2>Archive page layout</h2><p>Now we need to define a layout that Jekyll will use to output each archive page. I did this in a layout <code>_layouts/archive-year.html</code>. Here’s a simplified version of my file:</p><pre><code><span class="xml">---
layout: default
---
<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span></span><span class="hljs-template-variable">{{ page.title }}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
</span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-name">for</span></span> post <span class="hljs-keyword">in</span> site.posts %}</span><span class="xml">
    </span><span class="hljs-template-tag">{% <span class="hljs-name">capture</span> post_year %}</span><span class="xml"></span><span class="hljs-template-variable">{{ post.date | date: '%Y' }}</span><span class="xml"></span><span class="hljs-template-tag">{% <span class="hljs-name">endcapture</span> %}</span><span class="xml">
    </span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-name">if</span></span> post_year == page.year %}</span><span class="xml">
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"</span></span></span><span class="hljs-template-variable">{{ site.baseurl }}</span><span class="xml"><span class="hljs-tag"><span class="hljs-string"></span></span></span><span class="hljs-template-variable">{{ post.url }}</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span>&gt;</span></span><span class="hljs-template-variable">{{ post.title }}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>       
    </span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-name">endif</span></span> %}</span><span class="xml">
</span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-name">endfor</span></span> %}</span><span class="xml">
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
</span></code></pre><p>Its all pretty simple really. We’re looping though all the posts on the site, and only displaying them if they match the target year. By the way, those quotation marks from earlier are required for matching the <code>post_year</code> with <code>page.year</code>, which both have to be strings</p><p>And that’s it. A <em>sort-of</em> automatic way to generate an archive page-per-year.</p></article><nav class="m_prevNext"><div class="m_prevNext__item m_prevNext__item--prev"><div class="m_prevNext__icons m_prevNext__icons--prev" aria-hidden="true"><svg aria-hidden="true" class="m_icon m_icon--hand-point-left m_prevNext__hand--prev"><use xlink:href="/assets/sprites.svg#hand-point-left"></use></svg> <svg aria-hidden="true" class="m_icon m_icon--arm m_prevNext__arm--prev"><use xlink:href="/assets/sprites.svg#arm"></use></svg></div><p class="m_prevNext__label">Previous article:</p><a class="m_prevNext__link" href="/articles/50">What I talk about when I talk about beards</a></div><div class="m_prevNext__item m_prevNext__item--next"><div class="m_prevNext__icons m_prevNext__icons--next" aria-hidden="true"><svg aria-hidden="true" class="m_icon m_icon--arm m_prevNext__arm--next"><use xlink:href="/assets/sprites.svg#arm"></use></svg> <svg aria-hidden="true" class="m_icon m_icon--hand-point-right m_prevNext__hand--next"><use xlink:href="/assets/sprites.svg#hand-point-right"></use></svg></div><p class="m_prevNext__label">Next article:</p><a class="m_prevNext__link" href="/articles/52">Old hobbies die hard</a></div></nav></div></main><div class="c_fullscreen" id="main-menu"><div class="c_fullscreen__content"><div class="m_siteHeader"><a href="/" class="m_siteHeader__titleLink" title="Go to the homepage"><span class="m_siteHeader__intro">The personal website of</span> <span class="m_siteHeader__name">Jon Roobottom</span> </a><a href="#" class="m_siteHeader__menuLink" title="Toggle the main menu" data-fullscreen-close="#main-menu"><svg aria-hidden="true" class="m_icon m_icon--menu-close m_siteHeader__menuIcon m_icon--small" data-alt-icon="menu-close"><use xlink:href="/assets/sprites.svg#menu-close"></use></svg></a></div><nav class="m_navigation m_navigation--main"><ul class="m_navigation__items"><li class="m_navigation__item"><svg aria-hidden="true" class="m_icon m_icon--house m_navigation__icon"><use xlink:href="/assets/sprites.svg#house"></use></svg> <a href="/" class="m_navigation__link" title="Home"><span class="m_navigation__title">Home</span></a></li><li class="m_navigation__item"><svg aria-hidden="true" class="m_icon m_icon--teacup m_navigation__icon"><use xlink:href="/assets/sprites.svg#teacup"></use></svg> <a href="/articles" class="m_navigation__link" title="Articles"><span class="m_navigation__title">Articles</span></a></li><li class="m_navigation__item"><svg aria-hidden="true" class="m_icon m_icon--clipboard m_navigation__icon"><use xlink:href="/assets/sprites.svg#clipboard"></use></svg> <a href="/patterns" class="m_navigation__link" title="Pattern library"><span class="m_navigation__title">Pattern library</span></a></li></ul></nav><nav class="m_navigation m_navigation--inline-bleached"><ul class="m_navigation__items"><li class="m_navigation__item"><svg aria-hidden="true" class="m_icon m_icon--github m_navigation__icon m_icon--x-small"><use xlink:href="/assets/sprites.svg#github"></use></svg> <a href="https://github.com/roobottom" class="m_navigation__link" title="Github"><span class="m_navigation__title">Github</span></a></li><li class="m_navigation__item"><svg aria-hidden="true" class="m_icon m_icon--twitter m_navigation__icon m_icon--x-small"><use xlink:href="/assets/sprites.svg#twitter"></use></svg> <a href="https://twitter.com/roobottom" class="m_navigation__link" title="Twitter"><span class="m_navigation__title">Twitter</span></a></li></ul></nav></div></div><script src="/functionality.js"></script></body></html>